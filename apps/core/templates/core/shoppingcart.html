{% load static %}
<html lang="en">
<head>
    <title>{{title}} - Answer Done </title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="apple-touch-icon" href="{% static 'statics/img/apple-touch-icon-76x76.png' %}">
<link rel="apple-touch-icon" sizes="76x76" href="{% static 'statics/img/apple-touch-icon-76x76.png' %}">
<link rel="apple-touch-icon" sizes="120x120" href="{% static 'statics/img/apple-touch-icon-120x120.png' %}">
<link rel="apple-touch-icon" sizes="152x152" href="{% static 'statics/img/apple-touch-icon-152x152.png' %}">
<link rel="apple-touch-icon" sizes="180x180" href="{% static 'statics/img/apple-touch-icon-180x180.png' %}">
<link rel="icon" sizes="192x192" href="{% static 'statics/img/favicon.png' %}">
<link rel="shortcut icon" sizes="192x192" type="image/x-icon" href="{% static 'statics/img/favicon.png' %}">
<link rel="canonical" href="{{ request.scheme }}://{{ request.META.HTTP_HOST }}{{ request.path }}" />
<link rel="alternate" href="{{ request.scheme }}://{{ request.META.HTTP_HOST }}{{ request.path }}" hreflang="x-default"/>

<meta name="description" content="{{description}}">
<meta property="fb:app_id" content="">
<meta property="og:site_name" content="AnswerDone">
<meta property="og:title" content="{{title}}">
<meta property="og:type" content="website">
<meta property="og:description" content="{{description}}">
<meta property="og:image" content="{% static 'statics/img/logo_blue.png' %}">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:locale" content="en_US">
<meta property="og:url" content="{{ request.scheme }}://{{ request.META.HTTP_HOST }}{{ request.path }}">
<meta name="twitter:widgets:csp" content="on">
<meta name="twitter:url" content="{{ request.scheme }}://{{ request.META.HTTP_HOST }}{{ request.path }}">
<meta name="twitter:description" content="{{description}}">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{title}}">
<meta name="twitter:site" content="">
<meta name="twitter:image" content="Array">
<meta name="apple-mobile-web-app-title" content="AnswerDone">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="csrf-token" content="">

        <link rel="stylesheet" href=" {% static "statics/css/4505c350ae-checkoutpage_css.css" %}">
        <link rel="stylesheet" href="{% static 'statics/css/ee3b8afcf4-upload_pages_2_css.css' %}">
<style>
    form input[type=text] {
        width: 100%;
        padding: 15px 20px;
    }
    form input[type=text] {
        width: 100%;
        padding: 18px 33px;
        color: #199be9;
    }
    form input {
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 1;
        word-break: break-word;
    }
    form input, form textarea {
        background-color: #fff;
        -webkit-border-radius: 2px;
        -moz-border-radius: 2px;
        border-radius: 2px;
        border: 1px solid #d1ebfb;
    }
</style>
    </head>
    <body class="site">
        <div id="app" data-country="214" class="">
            <header class="main-header" style="position: fixed;">
                <div class="header-wrapper simple max-width">
                    <div class="wrapper-left">
                        <section class="logo-image desktop" id="home-btn-ampl" data-tab-name="">
                            <a href="/">
                                <figure>
                                    <img loading="lazy" alt="logo" src="{% static 'statics/img/logo_blue.png' %}">
                                </figure>
                            </a>
                        </section>
                        <div class="wrapper-center mobile">
                            <a href="/" class="logo-wrapper">
                            <img loading="lazy" src="{% static 'statics/img/logo-2.png' %}" alt="mobile-logo" class="image-pasif">
                            </a>
                        </div>
                    </div>
                </div>
            </header>
            <div id="page" class="wrapper checkout-page" data-page="checkout-page" data-login="yes" data-step="1">
                <article id="content" class="content-wrapper">
                    <nav class="navigation-checkout" data-nav-checkout="unfinish">
                        <!-- value finish to make indicator full & unfinsih to make indicator 1/2 -->
                        <ul class="nav-checkout-wrapper" data-nav-step="1">
                            <!-- value data-nav-step to make indicator tab (1 - 3) -->
                            <li><label>Payment Method</label></li>
                            <li class="current-item"><label>Checkout</label></li>
                            <li><label>Download</label></li>
                        </ul>
                    </nav>
                    <div id="main-section" class="section-entry-checkout">
                        <main class="entry-checkout-wrapper">
                            <div class="shopping-cart" id="primary-cart">
                                <h2 class="title-section title-element">Shopping cart</h2>
                                <ul class="list-product-cart">
                                    {% for item in cart %}
                                    <li class="list-product-item" id="cart-item-1-3464067">
                                        <div class="info-container">
                                            <div class="product-image">
                                                <img src="{{item.product.image.url}}">
                                            </div>
                                            <div class="product-info">
                                                <label class="type-product">{{item.product.category}}</label>
                                                <h4 class="product-name"><a href="{% url 'product_detail' item.product.category.slug item.product.slug %}">{{item.product.title}}</a></h4>
                                            </div>
                                            <div class="price-product">
                                                <span itemprop="price">${{item.product.price}}</span>
                                                {% comment %} <link itemprop="availability" href="http://schema.org/InStock"> {% endcomment %}
                                            </div>
                                            <div class="product-delete-wrap">
                                               <a href="{% url "remove_from_cart" item.product.id %}"> <span class="cta-delete-product" data-content-type="1" data-content-id="{{item.product.id}}">
                                                <i class="head-icon-trash far fa-trash-alt"></i>
                                                </span></a>
                                            </div>
                                        </div>
                                    </li>
                                    {% endfor %}
                                </ul>
                                <div class="table-price-wrapper">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td class="label-data">Service costs</td>
                                                <td id="service-cost">${{shop.service_costs}}</td>
                                            </tr>
                                            <tr class="total-price">
                                                <td class="label-data">Total</td>
                                                <td id="total-price">${{total_cost}}</td>
                                            </tr>
                                            <tr class="gray-tag-row">
                                                <td class="gray-tag">All prices are in USD</td>
                                                <td></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </main>
                        <aside class="widget-entry-checkout space-entry-content">
                            <form class="payment-method " action="{% url "checkout" %}" method="post" id='myform'>
                                {% csrf_token %}
                                {{form.as_p}}
                                <input type="hidden" id="paid_amount" name='paid_amount' value=''>
                                <input type="hidden" id="tr_id" name='tr_id' value=''>
                                <input type="hidden" id="tr_name" name='tr_name' value=''>
                                <input type="hidden" id="tr_email" name='tr_email' value=''>
                                <input type="hidden" id="tr_payer_id" name='tr_payer_id' value=''>
                                <input type="hidden" id="tr_payid" name='tr_payid' value=''>
                                <input type="hidden" id="tr_merchant_id" name='tr_merchant_id' value=''>
                                <div class="overlay">
                                    <div class="cv-spinner">
                                        <span class="spinner"></span>
                                    </div>
                                </div>
                                <h2 class="title-section title-element">Choose your payment method</h2>
                                <div class="text-end" id="paypal-button-container"></div>

                                <div class="term-condition">
                                    <p class="term-condition-notice">By proceeding, I fully understand and agree with the <a href="/termsofuse/" target="_blank">Terms of Use</a></p>
                                </div>
                                <button type="submit">Submit</button>
                            </form>
                        </aside>
                    </div>
                </article>
            </div>
            <footer class="checkout-footer shoppingcart">
                <div class="checkout-inner-footer">
                    Payments on AnswerDone are processed under the name of Stichting AnswerDone.
                </div>
            </footer>
        </div>
        {% comment %} <script src="https://www.paypal.com/sdk/js?client-id=EHbQJjfZk4Kq711_evQsV_RrGwfKcI4s17cmOsv3h2dBea6DSnN6cJ3oUlGpYD55ELUpVKGGZSw-osw2&currency=USD"></script> {% endcomment %}
        <script src="https://www.paypal.com/sdk/js?client-id=ASU6UQykcSp6cVT84zgoRDWpKU3tsBE5w7qXlADGfa2WxJ4vOEH0Z9g6W7yAW5mFUQ8VbxpSS244mw_x&currency=USD"></script>

        <script>
            // Render the PayPal button into #paypal-button-container
            paypal.Buttons({
                createOrder: function(data, actions) {
                    return actions.order.create({
                        purchase_units: [{
                            amount: {
                                value: '{{total_cost}}'
                            }
                        }]
                    });
                },
                onApprove: function(data, actions) {
                    return actions.order.capture().then(function(details) {
                        //console.log(details);
                        var id = details.id;
                        var given_name = details.payer.name.given_name;
                        var country_code = details.payer.address.country_code;
                        var email_address = details.payer.email_address;
                        var payer_id = details.payer.payer_id;
                        var value = details.purchase_units[0].amount.value;
                        var payid = details.purchase_units[0].payments.captures[0].id;
                        var merchant_id = details.purchase_units[0].payee.merchant_id;
                        var time = details.update_time;
                        document.getElementById('paid_amount').value = value;
                        document.getElementById('tr_id').value = id;
                        document.getElementById('tr_name').value = given_name;
                        document.getElementById('tr_email').value = email_address;
                        document.getElementById('tr_payer_id').value = payer_id;
                        document.getElementById('tr_payid').value = payid;
                        document.getElementById('tr_merchant_id').value = merchant_id;
                        document.getElementById('myform').submit();
                    });
                },
                onCancel(data) {
                  alert('payment has been cancelled')
      }
            }).render('#paypal-button-container');
        </script>
    </body>
</html>